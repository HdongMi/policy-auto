<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
    <title>ì‹¤ì‹œê°„ ë‰´ìŠ¤ - ì†Œìƒê³µì¸ ì •ì±… ì•Œë¦¬ë¯¸</title>
    <link rel="stylesheet" href="style.css" />
    <style>
        /* ë‰´ìŠ¤ í˜ì´ì§€ ì „ìš© ì¶”ê°€ ìŠ¤íƒ€ì¼ */
        .news-bundle { padding: 15px; }
        .news-item {
            background: white;
            padding: 16px;
            margin-bottom: 12px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            cursor: pointer;
            display: flex;
            flex-direction: column;
            transition: transform 0.2s;
        }
        .news-item:active { transform: scale(0.98); }
        .news-title {
            font-size: 16px;
            font-weight: bold;
            color: #1e293b;
            line-height: 1.4;
            margin-bottom: 8px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        .news-meta {
            font-size: 12px;
            color: #94a3b8;
            font-weight: 600;
            text-transform: uppercase;
        }
        /* ìŠ¤ì¼ˆë ˆí†¤ ë¡œë”© ì• ë‹ˆë©”ì´ì…˜ */
        .skeleton {
            background: #e2e8f0;
            background: linear-gradient(90deg, #e2e8f0 25%, #f1f5f9 50%, #e2e8f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
            border-radius: 4px;
        }
        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }
        /* ë¡œë”© ì˜¤ë²„ë ˆì´ */
        .loading-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255,255,255,0.9);
            display: none; align-items: center; justify-content: center;
            z-index: 1000; flex-direction: column;
        }
        /* ìŠ¤í”¼ë„ˆ ê°„ë‹¨ ì¶”ê°€ */
        .spinner {
            width: 40px; height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>

    <header class="header">
        <h1>ì‹¤ì‹œê°„ ì •ì±… ë‰´ìŠ¤</h1>
        <nav class="nav-tabs">
            <a href="info.html" class="tab-btn">ğŸ’¡ ì§€ì›ìê²© ì•ˆë‚´</a>
            <a href="index.html" class="tab-btn">ğŸ“‹ ê³µê³  ëª©ë¡</a>
            <a href="news.html" class="tab-btn active">ğŸ“° ì‹¤ì‹œê°„ ë‰´ìŠ¤ ë³´ê¸°</a>
        </nav>
    </header>

    <div class="section-title" style="padding: 20px 15px 5px 15px; font-weight: bold; color: #475569;">ì˜¤ëŠ˜ì˜ ì •ì±… ë‰´ìŠ¤</div>
    
    <div id="news-list" class="news-bundle">
        <div class="news-item">
            <div class="skeleton" style="height:18px; width:90%; margin-bottom:10px;"></div>
            <div class="skeleton" style="height:12px; width:40%;"></div>
        </div>
        <div class="news-item">
            <div class="skeleton" style="height:18px; width:85%; margin-bottom:10px;"></div>
            <div class="skeleton" style="height:12px; width:35%;"></div>
        </div>
    </div>

    <div id="newsOverlay" class="loading-overlay">
        <div class="spinner"></div>
        <p style="margin-top:15px; color:#64748b; font-weight:500;">ê¸°ì‚¬ í˜ì´ì§€ë¡œ ì´ë™ ì¤‘...</p>
    </div>

    <script>
        function openNews(url) {
            const overlay = document.getElementById('newsOverlay');
            overlay.style.display = 'flex';
            setTimeout(() => { window.location.href = url; }, 800);
        }

        async function fetchNews() {
            const newsContainer = document.getElementById('news-list');
            try {
                // 1. ê²€ìƒ‰ ì¿¼ë¦¬ ìˆ˜ì • (ì—¬ëŸ¬ ì¸ìê°€ ì•„ë‹Œ í•˜ë‚˜ì˜ ë¬¸ìì—´ë¡œ ê²°í•©)
                const queryText = 'ì†Œìƒê³µì¸ ì§€ì›ì •ì±… OR ì†Œìƒê³µì¸ ì§€ì›ê¸ˆ';
                const query = encodeURIComponent(queryText);
                const rssUrl = encodeURIComponent(`https://news.google.com/rss/search?q=${query}&hl=ko&gl=KR&ceid=KR:ko`);
                
                // 2. API í˜¸ì¶œ ì‹œ &count=20 ì¶”ê°€ (rss2jsonì˜ íŒŒë¼ë¯¸í„°)
                const response = await fetch(`https://api.rss2json.com/v1/api.json?rss_url=${rssUrl}&count=20`);
                const data = await response.json();
                
                if (data.items && data.items.length > 0) {
                    // 3. ë‚ ì§œ ë‚´ë¦¼ì°¨ìˆœ(ìµœì‹ ìˆœ) ì •ë ¬ ë¡œì§ ì¶”ê°€
                    const sortedItems = data.items.sort((a, b) => {
                        return new Date(b.pubDate) - new Date(a.pubDate);
                    });

                    newsContainer.innerHTML = ''; // ìŠ¤ì¼ˆë ˆí†¤ ì œê±°
                    
                    // 4. ì •ë ¬ëœ ë¦¬ìŠ¤íŠ¸ì—ì„œ ìµœëŒ€ 20ê°œ ì¶œë ¥
                    sortedItems.slice(0, 20).forEach(item => {
                        const date = new Date(item.pubDate).toLocaleDateString('ko-KR', {
                            year: 'numeric',
                            month: '2-digit',
                            day: '2-digit'
                        });
                        const itemLink = item.link;
                        const itemEl = document.createElement('div');
                        itemEl.className = 'news-item';
                        itemEl.innerHTML = `
                            <span class="news-title">${item.title}</span>
                            <span class="news-meta">LATEST NEWS Â· ${date}</span>
                        `;
                        itemEl.onclick = () => openNews(itemLink);
                        newsContainer.appendChild(itemEl);
                    });
                } else {
                    throw new Error('No items');
                }
            } catch (e) {
                console.error(e);
                newsContainer.innerHTML = '<p style="padding:40px; text-align:center; color:#94a3b8;">ë‰´ìŠ¤ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.<br>ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.</p>';
            }
        }

        window.onload = fetchNews;
    </script>
</body>
</html>
